{% extends 'base.html' %}
{% block title %}Listado de Usuarios{% endblock %}
{% block content %}
<h1>Listado de Usuarios</h1>
<a href="{{ url_for('main.crear_usuario') }}" class="btn btn-primary mb-3">Crear Nuevo Usuario</a>

<form method="GET" class="form-inline mb-3">
    <div class="form-group mr-2">
        <input type="text" name="nombre_usuario" class="form-control" placeholder="Nombre de Usuario" value="{{ request.args.get('nombre_usuario', '') }}">
    </div>
    <div class="form-group mr-2">
        <select name="tienda" class="form-control">
            <option value="">Todas las Tiendas</option>
            <option value="casa_central">Casa Central</option>
            {% for tienda in tiendas %}
                <option value="{{ tienda.codigo }}" {% if request.args.get('tienda') == tienda.codigo %}selected{% endif %}>{{ tienda.nombre }}</option>
            {% endfor %}
        </select>
    </div>
    <button type="submit" class="btn btn-secondary">Filtrar</button>
</form>

<table class="table table-striped">
    <thead>
        <tr>
            <th>Nombre de Usuario</th>
            <th>Tienda</th>
            <th>Estado</th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody>
        {% for usuario in usuarios %}
        <tr>
            <td>{{ usuario.nombre_usuario }}</td>
            <td>{{ 'Casa Central' if usuario.tienda == 'casa_central' else usuario.tienda }}</td>
            <td>{{ 'Habilitado' if usuario.habilitado else 'Deshabilitado' }}</td>
            <td>
                <a href="{{ url_for('main.detalle_usuario', nombre_usuario=usuario.nombre_usuario) }}" class="btn btn-info btn-sm">Detalles</a>
                <form action="{{ url_for('main.eliminar_usuario', nombre_usuario=usuario.nombre_usuario) }}" method="POST" style="display:inline;">
                    <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('¿Estás seguro de eliminar este usuario?');">Eliminar</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}